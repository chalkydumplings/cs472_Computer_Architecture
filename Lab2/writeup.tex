\documentclass[letterpaper,12pt,titlepage]{article}

\usepackage{graphicx}                                        
\usepackage{amssymb}                                         
\usepackage{amsmath}                                         
\usepackage{amsthm}                                          

\usepackage{alltt}                                           
\usepackage{float}
\usepackage{color}
\usepackage{url}

%\usepackage{balance}
%\usepackage[TABBOTCAP, tight]{subfigure}
%\usepackage{enumitem}
\usepackage{pstricks, pst-node}

\usepackage{listings}

\usepackage{geometry}
\geometry{textheight=9in, textwidth=6.5in}

%random comment

\newcommand{\cred}[1]{{\color{red}#1}}
\newcommand{\cblue}[1]{{\color{blue}#1}}

\usepackage{hyperref}
\usepackage{geometry}

\def\name{Drake Bridgewater \\  Ryan Phillips}
\def\title{Lab 2 - The ARM ISA}
\def\subtitle{}
\def\subject{CS }
\def\courseNumber{ 472 }
\def\courseName{Computer Architecture }
\def\courseInfo{Spring 2014 }%Class Time: MWF X-X:XX AM}
\def\supervisor{Kevin \textsc{McGrath}} % Supervisor's Name


%pull in the necessary preamble matter for pygments output
\input{pygments.tex}

%% The following metadata will show up in the PDF properties
 \hypersetup{
   colorlinks = false,
   urlcolor = black,
   pdfauthor = {\name},
   pdfkeywords = {\title, \subject, \courseNumber, \courseName, \supervisor},
   pdftitle = {\title},
   pdfsubject = {\subject},
   pdfpagemode = UseNone
 }

\parindent = 0.0 in
\parskip = 0.1 in

\begin{document}


\begin{titlepage}

\newcommand{\HRule}{\rule{\linewidth}{0.5mm}} % Defines a new command for the horizontal lines, change thickness here

\center % Center everything on the page
 
%----------------------------------------------------------------------------------------
%        HEADING SECTIONS
%----------------------------------------------------------------------------------------

\textsc{\LARGE Oregon State University}\\[1.5cm] % Name of your university/college
\textsc{\Large \subject \courseNumber - \courseName}\\[0.5cm] % Major heading such as course name
\textsc{\large \courseInfo}\\[0.5cm] % Minor heading such as course title

%----------------------------------------------------------------------------------------
%        TITLE SECTION
%----------------------------------------------------------------------------------------

\HRule \\[0.4cm]
{ \huge \bfseries \title }\\[0.4cm] % Title of your document
{\small \textit{\subtitle}}\\[0.4cm]
\HRule \\[1.5cm]
 
%----------------------------------------------------------------------------------------
%        AUTHOR SECTION
%----------------------------------------------------------------------------------------

\begin{minipage}{0.4\textwidth}
\begin{flushleft} \large
\emph{Author:}\\
\name
\end{flushleft}
\end{minipage}
~
\begin{minipage}{0.4\textwidth}
\begin{flushright} \large
\emph{Professor:} \\
\supervisor
\end{flushright}
\end{minipage}\\[4cm]

% If you don't want a supervisor, uncomment the two lines below and remove the section above
%\Large \emph{Author:}\\
%John \textsc{Smith}\\[3cm] % Your name

%----------------------------------------------------------------------------------------
%        DATE SECTION
%----------------------------------------------------------------------------------------

{\large \today}\\[3cm] % Date, change the \today to a set date if you want to be precise

%----------------------------------------------------------------------------------------
%        LOGO SECTION
%----------------------------------------------------------------------------------------

%\includegraphics{Logo}\\[1cm] % Include a department/university logo - this will require the graphicx package
 
%----------------------------------------------------------------------------------------

\vfill % Fill the rest of the page with whitespace

\end{titlepage}

%\tableofcontents
%\vfill % Fill the rest of the page with whitespace
%\newpage

\section*{Getting started}
Begin with reading the introduction the KEIL simulator on pages 16-29 of \href{http://academic.cengage.com/resource_uploads/downloads/1111987041_374273.pdf}{the Student Workbook}  which accompanies the textbook 

\section*{Part 1}
Please provide answers to the problems in Problem Set 5 in the Student Workbook. Here we provide an introduction to the Keil ARM processor development system.


\subsection*{1)} Write a simple program to perform:  $Z = A+B+B-(D \times E)$

The instructions you may use are ADD, SUB, and MUL. Assume that the data is in registers r0 to r4 (representing A to E) and the result is put in r5. 

Enter your program into the Keil simulator and run it. You can use move instruction to load data into registers. Do you
get the expected answer? 

While watching the register reflect each line of code I was able to view each commands effects on the bits. This allowed me to realize that the add operation and subtraction operations are performed exactly as expected, but once the multiplication command came into play I noticed that when the numbers are smaller minus larger the result is a negative. 
\lstinputlisting{lab2_1.asm}
 
\subsection*{2)} Now assume A, B, C, D and E are 16-bit values in memory. You can load them by using a DCD directive. Remember that you use a label to define the first memory location and you can put successive values on the same line by  separating them by commas. However, since each data item needs its own name, you are going to have to use one directive per element; that is:,  

A   DCD  4
B   DCD  12
C   DCD  -2
 
Enter the program, compile (build) it and test it.
 
\subsection*{3)} Write a program that includes deliberate syntax errors.   Enter it in the development system, assemble (build) it and
then debug it. 



\newpage
\section*{Part 2: Examination of compiler output}
In the homework, you were asked to write an assembly routine that checks for palindromes in odd length strings. For this portion of the lab, please write a simple C program that does the same thing, use the \href{http://gcc.godbolt.org}{web based compiler} and compile your  C code to ARM assembly (use arm-linux-gnueabi-g++-4.6 with option -O0). Compare this assembly with what you wrote. Modify the optimization level from 0 to one of the values in the set {1,2,3,s}. What changes? Why do you think these changes were made?

For this lab, you will need to create a write-up discussing the differences you see in Part 2. Do you see any interesting features being used? Is the hand assembly you wrote significantly different than what the compiler produced? Which uses fewer instructions? In other words, provide an analysis of Part 2.

%\lstinputlisting[language=C]{feature_extraction.c}

\end{document}

